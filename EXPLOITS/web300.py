import requests as req
import json
if __name__ == '__main__':
    s = req.Session()

    cookies = {'token': 'c4ca4238a0b923820dcc509a6f75849b'}

    permissions = {
        'ROLE_USER': 'разблокирован',
        'ROLE_ADMIM': 'заблокирован'
    }

    while True:
        data = s.get('http://10.10.10.72:8080/api/users', cookies=cookies)
        data = json.loads(data.text)
        for user in data:
            if user['role'] == 'ROLE_ADMIN' or (user['role'] == 'ROLE_ADMIN' and user['login'] == 'nzkoff'):
                data = s.post('http://10.10.10.72:8080/api/admin/permissions', data={'login': user['login']}, cookies=cookies)
                data = json.load(data.text)

                for cur_user in data:
                    print(cur_user)

                    role = cur_user['role'] == 'ROLE_USER'
                    if role  == 'ROLE_USER':
                        print('Пользователю {} {} доступ к админке. Текущая роль: {}'.format(cur_user['login'], permissions[role], cur_user['role']))

